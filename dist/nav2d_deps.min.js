!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.nav2d=t():n.nav2d=t()}("undefined"!=typeof self?self:this,(function(){return function(n){var t={};function e(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(r,i,function(t){return n[t]}.bind(null,i));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=5)}([function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=e(4);t.uuid=function(){return r.v4()};const i={v4:/(?:^[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}$)|(?:^0{8}-0{4}-0{4}-0{4}-0{12}$)/u,v5:/(?:^[a-f0-9]{8}-[a-f0-9]{4}-5[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}$)|(?:^0{8}-0{4}-0{4}-0{4}-0{12}$)/u};t.regex=i;t.isUuid=function(n){return i.v4.test(n)||i.v5.test(n)};t.empty=function(){return"00000000-0000-0000-0000-000000000000"};t.fromString=function(n){return r.v5(n,"bb5d0ffa-9a4c-4d7c-8fc2-0a7d2220ba45")}},function(n,t){n.exports=function(n,t){for(var e=n[0],r=n[1],i=!1,u=0,o=t.length-1;u<t.length;o=u++){var a=t[u][0],f=t[u][1],l=t[o][0],c=t[o][1];f>r!=c>r&&e<(l-a)*(r-f)/(c-f)+a&&(i=!i)}return i}},function(n,t,e){"use strict";function r(n,t,e){e=e||2;var r,a,f,l,c,y,p,x=t&&t.length,d=x?t[0]*e:n.length,g=i(n,0,d,e,!0),b=[];if(!g||g.next===g.prev)return b;if(x&&(g=function(n,t,e,r){var o,a,f,l,c,y=[];for(o=0,a=t.length;o<a;o++)f=t[o]*r,l=o<a-1?t[o+1]*r:n.length,(c=i(n,f,l,r,!1))===c.next&&(c.steiner=!0),y.push(v(c));for(y.sort(s),o=0;o<y.length;o++)h(y[o],e),e=u(e,e.next);return e}(n,t,g,e)),n.length>80*e){r=f=n[0],a=l=n[1];for(var m=e;m<d;m+=e)(c=n[m])<r&&(r=c),(y=n[m+1])<a&&(a=y),c>f&&(f=c),y>l&&(l=y);p=0!==(p=Math.max(f-r,l-a))?1/p:0}return o(g,b,e,r,a,p),b}function i(n,t,e,r,i){var u,o;if(i===N(n,t,e,r)>0)for(u=t;u<e;u+=r)o=j(u,n[u],n[u+1],o);else for(u=e-r;u>=t;u-=r)o=j(u,n[u],n[u+1],o);return o&&b(o,o.next)&&(P(o),o=o.next),o}function u(n,t){if(!n)return n;t||(t=n);var e,r=n;do{if(e=!1,r.steiner||!b(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(P(r),(r=t=r.prev)===r.next)break;e=!0}}while(e||r!==t);return t}function o(n,t,e,r,i,s,h){if(n){!h&&s&&function(n,t,e,r){var i=n;do{null===i.z&&(i.z=p(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,function(n){var t,e,r,i,u,o,a,f,l=1;do{for(e=n,n=null,u=null,o=0;e;){for(o++,r=e,a=0,t=0;t<l&&(a++,r=r.nextZ);t++);for(f=l;a>0||f>0&&r;)0!==a&&(0===f||!r||e.z<=r.z)?(i=e,e=e.nextZ,a--):(i=r,r=r.nextZ,f--),u?u.nextZ=i:n=i,i.prevZ=u,u=i;e=r}u.nextZ=null,l*=2}while(o>1)}(i)}(n,r,i,s);for(var y,v,x=n;n.prev!==n.next;)if(y=n.prev,v=n.next,s?f(n,r,i,s):a(n))t.push(y.i/e),t.push(n.i/e),t.push(v.i/e),P(n),n=v.next,x=v.next;else if((n=v)===x){h?1===h?o(n=l(u(n),t,e),t,e,r,i,s,2):2===h&&c(n,t,e,r,i,s):o(u(n),t,e,r,i,s,1);break}}}function a(n){var t=n.prev,e=n,r=n.next;if(g(t,e,r)>=0)return!1;for(var i=n.next.next;i!==n.prev;){if(x(t.x,t.y,e.x,e.y,r.x,r.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function f(n,t,e,r){var i=n.prev,u=n,o=n.next;if(g(i,u,o)>=0)return!1;for(var a=i.x<u.x?i.x<o.x?i.x:o.x:u.x<o.x?u.x:o.x,f=i.y<u.y?i.y<o.y?i.y:o.y:u.y<o.y?u.y:o.y,l=i.x>u.x?i.x>o.x?i.x:o.x:u.x>o.x?u.x:o.x,c=i.y>u.y?i.y>o.y?i.y:o.y:u.y>o.y?u.y:o.y,s=p(a,f,t,e,r),h=p(l,c,t,e,r),y=n.prevZ,v=n.nextZ;y&&y.z>=s&&v&&v.z<=h;){if(y!==n.prev&&y!==n.next&&x(i.x,i.y,u.x,u.y,o.x,o.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,v!==n.prev&&v!==n.next&&x(i.x,i.y,u.x,u.y,o.x,o.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;y&&y.z>=s;){if(y!==n.prev&&y!==n.next&&x(i.x,i.y,u.x,u.y,o.x,o.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=h;){if(v!==n.prev&&v!==n.next&&x(i.x,i.y,u.x,u.y,o.x,o.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function l(n,t,e){var r=n;do{var i=r.prev,o=r.next.next;!b(i,o)&&m(i,r,r.next,o)&&k(i,o)&&k(o,i)&&(t.push(i.i/e),t.push(r.i/e),t.push(o.i/e),P(r),P(r.next),r=n=o),r=r.next}while(r!==n);return u(r)}function c(n,t,e,r,i,a){var f=n;do{for(var l=f.next.next;l!==f.prev;){if(f.i!==l.i&&d(f,l)){var c=O(f,l);return f=u(f,f.next),c=u(c,c.next),o(f,t,e,r,i,a),void o(c,t,e,r,i,a)}l=l.next}f=f.next}while(f!==n)}function s(n,t){return n.x-t.x}function h(n,t){if(t=function(n,t){var e,r=t,i=n.x,u=n.y,o=-1/0;do{if(u<=r.y&&u>=r.next.y&&r.next.y!==r.y){var a=r.x+(u-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o){if(o=a,a===i){if(u===r.y)return r;if(u===r.next.y)return r.next}e=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!e)return null;if(i===o)return e;var f,l=e,c=e.x,s=e.y,h=1/0;r=e;do{i>=r.x&&r.x>=c&&i!==r.x&&x(u<s?i:o,u,c,s,u<s?o:i,u,r.x,r.y)&&(f=Math.abs(u-r.y)/(i-r.x),k(r,n)&&(f<h||f===h&&(r.x>e.x||r.x===e.x&&y(e,r)))&&(e=r,h=f)),r=r.next}while(r!==l);return e}(n,t)){var e=O(t,n);u(t,t.next),u(e,e.next)}}function y(n,t){return g(n.prev,n,t.prev)<0&&g(t.next,n,n.next)<0}function p(n,t,e,r,i){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-e)*i)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v(n){var t=n,e=n;do{(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next}while(t!==n);return e}function x(n,t,e,r,i,u,o,a){return(i-o)*(t-a)-(n-o)*(u-a)>=0&&(n-o)*(r-a)-(e-o)*(t-a)>=0&&(e-o)*(u-a)-(i-o)*(r-a)>=0}function d(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(n,t){var e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&m(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}(n,t)&&(k(n,t)&&k(t,n)&&function(n,t){var e=n,r=!1,i=(n.x+t.x)/2,u=(n.y+t.y)/2;do{e.y>u!=e.next.y>u&&e.next.y!==e.y&&i<(e.next.x-e.x)*(u-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next}while(e!==n);return r}(n,t)&&(g(n.prev,n,t.prev)||g(n,t.prev,t))||b(n,t)&&g(n.prev,n,n.next)>0&&g(t.prev,t,t.next)>0)}function g(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function b(n,t){return n.x===t.x&&n.y===t.y}function m(n,t,e,r){var i=_(g(n,t,e)),u=_(g(n,t,r)),o=_(g(e,r,n)),a=_(g(e,r,t));return i!==u&&o!==a||(!(0!==i||!w(n,e,t))||(!(0!==u||!w(n,r,t))||(!(0!==o||!w(e,n,r))||!(0!==a||!w(e,t,r)))))}function w(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function _(n){return n>0?1:n<0?-1:0}function k(n,t){return g(n.prev,n,n.next)<0?g(n,t,n.next)>=0&&g(n,n.prev,t)>=0:g(n,t,n.prev)<0||g(n,n.next,t)<0}function O(n,t){var e=new A(n.i,n.x,n.y),r=new A(t.i,t.x,t.y),i=n.next,u=t.prev;return n.next=t,t.prev=n,e.next=i,i.prev=e,r.next=e,e.prev=r,u.next=r,r.prev=u,r}function j(n,t,e,r){var i=new A(n,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function P(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function A(n,t,e){this.i=n,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function N(n,t,e,r){for(var i=0,u=t,o=e-r;u<e;u+=r)i+=(n[o]-n[u])*(n[u+1]+n[o+1]),o=u;return i}n.exports=r,n.exports.default=r,r.deviation=function(n,t,e,r){var i=t&&t.length,u=i?t[0]*e:n.length,o=Math.abs(N(n,0,u,e));if(i)for(var a=0,f=t.length;a<f;a++){var l=t[a]*e,c=a<f-1?t[a+1]*e:n.length;o-=Math.abs(N(n,l,c,e))}var s=0;for(a=0;a<r.length;a+=3){var h=r[a]*e,y=r[a+1]*e,p=r[a+2]*e;s+=Math.abs((n[h]-n[p])*(n[y+1]-n[h+1])-(n[h]-n[y])*(n[p+1]-n[h+1]))}return 0===o&&0===s?0:Math.abs((s-o)/o)},r.flatten=function(n){for(var t=n[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,i=0;i<n.length;i++){for(var u=0;u<n[i].length;u++)for(var o=0;o<t;o++)e.vertices.push(n[i][u][o]);i>0&&(r+=n[i-1].length,e.holes.push(r))}return e}},function(n,t,e){n.exports=function(n,t,e,r,i){("number"!=typeof n||isNaN(n))&&(n=0),("number"!=typeof t||isNaN(t))&&(t=0),("number"!=typeof e||isNaN(e))&&(e=10),("number"!=typeof r||isNaN(r))&&(r=10);var u=25,o=.5;function a(n){return!!n&&("number"==typeof n.x&&"number"==typeof n.y&&"number"==typeof n.w&&"number"==typeof n.h&&(!(isNaN(n.x)||isNaN(n.y)||isNaN(n.w)||isNaN(n.h))&&!(n.w<0||n.h<0)))}function f(n,t){return n.x==t.x&&n.y==t.y&&n.w==t.w&&n.h==t.h}function l(n,t,e,r){return{x:n,y:t,w:e,h:r,c:[],l:[],n:[]}}i&&("number"==typeof i.maxchildren&&i.maxchildren>0&&(u=i.maxchildren),"number"==typeof i.leafratio&&i.leafratio>=0&&(o=i.leafratio));var c=l(n,t,e,r);function s(n,t,e,r){return Math.sqrt((e-n)*(e-n)+(r-t)*(r-t))}function h(n,t,e){if(!n||!t)return!0;var r=function(n,t,e,r,i,u,o){o||(o=-1);var a=i*i+u*u;if(0==a)return null;if(a=(n*u-t*i-e*u+r*i)/a,Math.abs(i)>Math.abs(u))var f=(n-e-a*u)/i;else f=(t-r+a*i)/u;return f>=0&&f<=o||o<0?{s:f,t:a,x:e+f*i,y:r+f*u,dist:Math.abs(a)}:f<0?{s:f,dist:s(n,t,e,r)}:{s:f,dist:s(n,t,e+o*i,r+o*u)}}(t.x+.5*t.w,t.y+.5*t.h,n.x,n.y,n.dx,n.dy,n.dist);if(r){if(r.dist-=e,r.dist<0)return!0;if(r.dist*r.dist<=t.w*t.w+t.h*t.h)return!0}return!1}function y(n,t,e){return!n||!t||!(n.x+n.w<t.x-e||n.y+n.h<t.y-e||n.x-e>t.x+t.w||n.y-e>t.y+t.h)}function p(n,t){var e=!1;t.w*t.h>n.w*n.h*o&&(e=!0),(t.x<n.x||t.y<n.y||t.x+t.w>n.x+n.w||t.y+t.h>n.y+n.h)&&(e=!0);for(var r=null,i=0;i<n.n.length;i++)if(y(t,n.n[i],0)){if(r){e=!0;break}r=n.n[i]}return{leaf:e,childnode:r}}function v(n,t){var e=p(n,t);if(e.leaf)n.l.push(t);else{if(!e.childnode)return;d(e.childnode,t)}}function x(n,t){n.x="number"==typeof t.x?t.x:n.x,n.y="number"==typeof t.y?t.y:n.y,n.w="number"==typeof t.w?t.w:n.w,n.h="number"==typeof t.h?t.h:n.h}function d(n,t){if(a(t))if(0==n.n.length){if(n.c.push(t),n.c.length>u){var e=n.w/2,r=n.h/2;n.n.push(l(n.x,n.y,e,r),l(n.x+e,n.y,e,r),l(n.x,n.y+r,e,r),l(n.x+e,n.y+r,e,r));for(var i=0;i<n.c.length;i++)v(n,n.c[i]);n.c=[]}}else v(n,t)}function g(n,t,e,r,i,u){for(var o=0;o<t.l.length;o++)if(!i||n(e,t.l[o],r))if("object"==typeof u)u.push(t.l[o]);else if(!u(t.l[o]))return!1;for(o=0;o<t.c.length;o++)if(!i||n(e,t.c[o],r))if("object"==typeof u)u.push(t.c[o]);else if(!u(t.c[o]))return!1;for(var a=0;a<t.n.length;a++)if(n(e,t.n[a],r))if("object"==typeof u)u.concat(g(n,t.n[a],e,r,i,u));else if(!g(n,t.n[a],e,r,i,u))return!1;return!0}function b(n,t,e,r){return g(y,n,t,e,!0,r)}function m(n,t,e,r){if("function"!=typeof e&&"object"!=typeof e||void 0!==r||(r=e,e=0),void 0===r&&(r=[],e=0),null==t?b(n,t,e,r):"number"!=typeof t.x||"number"!=typeof t.y||isNaN(t.x)||isNaN(t.y)||("number"!=typeof t.dx||"number"!=typeof t.dy||isNaN(t.dx)||isNaN(t.dy)?"number"!=typeof t.w||"number"!=typeof t.h||isNaN(t.w)||isNaN(t.h)||b(n,t,e,r):function(n,t,e,r){g(h,n,t,e,!1,r)}(n,t,e,r)),"object"==typeof r)return r}return{get:function(n,t,e){return m(c,n,t,e)},put:function(n){d(c,n)},update:function(n,t,e){return function n(t,e,r,i){if("object"==typeof r&&void 0===i&&(i=r,r=!1),!a(e)||void 0===i)return!1;r?"string"!=typeof r&&(r="id"):r=!1;for(var u=0;u<t.c.length;u++)if(r&&t.c[u][r]==e[r]||!r&&f(t.c[u],e)){return x(o=t.c[u],i),(o.x>t.x+t.w||o.y>t.y+t.h||o.x+o.w<t.x||o.y+o.h<t.y)&&(t.c.splice(u,1),d(c,o)),!0}for(u=0;u<t.l.length;u++)if(r&&t.l[u][r]==e[r]||!r&&f(t.l[u],e)){var o;return x(o=t.l[u],i),(o.x>t.x+t.w||o.y>t.y+t.h||o.x+o.w<t.x||o.y+o.h<t.y)&&(t.l.splice(u,1),d(c,o)),!0}var l=p(t,e);return!(l.leaf||!l.childnode||!n(l.childnode,e,r))}(c,n,t,e)},remove:function(n,t){return function n(t,e,r){if(!a(e))return 0;r?"string"!=typeof r&&(r="id"):r=!1;for(var i=0,u=0;u<t.c.length;u++)(r&&t.c[u][r]==e[r]||!r&&f(t.c[u],e))&&(i++,t.c.splice(u,1),u--);for(u=0;u<t.l.length;u++)(r&&t.l[u][r]==e[r]||!r&&f(t.l[u],e))&&(i++,t.l.splice(u,1),u--);var o=p(t,e);return!o.leaf&&o.childnode?i+n(o.childnode,e,r):i}(c,n,t)},clear:function(){c=l(n,t,e,r)},stringify:function(){var i={x:n,y:t,w:e,h:r,maxc:u,leafratio:o,root:c};try{return JSON.stringify(i)}catch(n){return null}},parse:function(i){"string"==typeof i&&(i=JSON.parse(i)),n=i.x,t=i.y,e=i.w,r=i.h,u=i.maxc,o=i.leafratio,c=i.root}}}},function(n,t,e){"use strict";e.r(t),e.d(t,"v1",(function(){return y})),e.d(t,"v3",(function(){return w})),e.d(t,"v4",(function(){return _})),e.d(t,"v5",(function(){return j}));var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),i=new Uint8Array(16);function u(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}for(var o=[],a=0;a<256;++a)o[a]=(a+256).toString(16).substr(1);var f,l,c=function(n,t){var e=t||0,r=o;return[r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]]].join("")},s=0,h=0;var y=function(n,t,e){var r=t&&e||0,i=t||[],o=(n=n||{}).node||f,a=void 0!==n.clockseq?n.clockseq:l;if(null==o||null==a){var y=n.random||(n.rng||u)();null==o&&(o=f=[1|y[0],y[1],y[2],y[3],y[4],y[5]]),null==a&&(a=l=16383&(y[6]<<8|y[7]))}var p=void 0!==n.msecs?n.msecs:(new Date).getTime(),v=void 0!==n.nsecs?n.nsecs:h+1,x=p-s+(v-h)/1e4;if(x<0&&void 0===n.clockseq&&(a=a+1&16383),(x<0||p>s)&&void 0===n.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,h=v,l=a;var d=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var g=p/4294967296*1e4&268435455;i[r++]=g>>>8&255,i[r++]=255&g,i[r++]=g>>>24&15|16,i[r++]=g>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var b=0;b<6;++b)i[r+b]=o[b];return t||c(i)};var p=function(n,t,e){var r=function(n,r,i,u){var o=i&&u||0;if("string"==typeof n&&(n=function(n){n=unescape(encodeURIComponent(n));for(var t=new Array(n.length),e=0;e<n.length;e++)t[e]=n.charCodeAt(e);return t}(n)),"string"==typeof r&&(r=function(n){var t=[];return n.replace(/[a-fA-F0-9]{2}/g,(function(n){t.push(parseInt(n,16))})),t}(r)),!Array.isArray(n))throw TypeError("value must be an array of bytes");if(!Array.isArray(r)||16!==r.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var a=e(r.concat(n));if(a[6]=15&a[6]|t,a[8]=63&a[8]|128,i)for(var f=0;f<16;++f)i[o+f]=a[f];return i||c(a)};try{r.name=n}catch(n){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r};function v(n,t){var e=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(e>>16)<<16|65535&e}function x(n,t,e,r,i,u){return v((o=v(v(t,n),v(r,u)))<<(a=i)|o>>>32-a,e);var o,a}function d(n,t,e,r,i,u,o){return x(t&e|~t&r,n,t,i,u,o)}function g(n,t,e,r,i,u,o){return x(t&r|e&~r,n,t,i,u,o)}function b(n,t,e,r,i,u,o){return x(t^e^r,n,t,i,u,o)}function m(n,t,e,r,i,u,o){return x(e^(t|~r),n,t,i,u,o)}var w=p("v3",48,(function(n){if("string"==typeof n){var t=unescape(encodeURIComponent(n));n=new Array(t.length);for(var e=0;e<t.length;e++)n[e]=t.charCodeAt(e)}return function(n){var t,e,r,i=[],u=32*n.length;for(t=0;t<u;t+=8)e=n[t>>5]>>>t%32&255,r=parseInt("0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e),16),i.push(r);return i}(function(n,t){var e,r,i,u,o;n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;var a=1732584193,f=-271733879,l=-1732584194,c=271733878;for(e=0;e<n.length;e+=16)r=a,i=f,u=l,o=c,a=d(a,f,l,c,n[e],7,-680876936),c=d(c,a,f,l,n[e+1],12,-389564586),l=d(l,c,a,f,n[e+2],17,606105819),f=d(f,l,c,a,n[e+3],22,-1044525330),a=d(a,f,l,c,n[e+4],7,-176418897),c=d(c,a,f,l,n[e+5],12,1200080426),l=d(l,c,a,f,n[e+6],17,-1473231341),f=d(f,l,c,a,n[e+7],22,-45705983),a=d(a,f,l,c,n[e+8],7,1770035416),c=d(c,a,f,l,n[e+9],12,-1958414417),l=d(l,c,a,f,n[e+10],17,-42063),f=d(f,l,c,a,n[e+11],22,-1990404162),a=d(a,f,l,c,n[e+12],7,1804603682),c=d(c,a,f,l,n[e+13],12,-40341101),l=d(l,c,a,f,n[e+14],17,-1502002290),f=d(f,l,c,a,n[e+15],22,1236535329),a=g(a,f,l,c,n[e+1],5,-165796510),c=g(c,a,f,l,n[e+6],9,-1069501632),l=g(l,c,a,f,n[e+11],14,643717713),f=g(f,l,c,a,n[e],20,-373897302),a=g(a,f,l,c,n[e+5],5,-701558691),c=g(c,a,f,l,n[e+10],9,38016083),l=g(l,c,a,f,n[e+15],14,-660478335),f=g(f,l,c,a,n[e+4],20,-405537848),a=g(a,f,l,c,n[e+9],5,568446438),c=g(c,a,f,l,n[e+14],9,-1019803690),l=g(l,c,a,f,n[e+3],14,-187363961),f=g(f,l,c,a,n[e+8],20,1163531501),a=g(a,f,l,c,n[e+13],5,-1444681467),c=g(c,a,f,l,n[e+2],9,-51403784),l=g(l,c,a,f,n[e+7],14,1735328473),f=g(f,l,c,a,n[e+12],20,-1926607734),a=b(a,f,l,c,n[e+5],4,-378558),c=b(c,a,f,l,n[e+8],11,-2022574463),l=b(l,c,a,f,n[e+11],16,1839030562),f=b(f,l,c,a,n[e+14],23,-35309556),a=b(a,f,l,c,n[e+1],4,-1530992060),c=b(c,a,f,l,n[e+4],11,1272893353),l=b(l,c,a,f,n[e+7],16,-155497632),f=b(f,l,c,a,n[e+10],23,-1094730640),a=b(a,f,l,c,n[e+13],4,681279174),c=b(c,a,f,l,n[e],11,-358537222),l=b(l,c,a,f,n[e+3],16,-722521979),f=b(f,l,c,a,n[e+6],23,76029189),a=b(a,f,l,c,n[e+9],4,-640364487),c=b(c,a,f,l,n[e+12],11,-421815835),l=b(l,c,a,f,n[e+15],16,530742520),f=b(f,l,c,a,n[e+2],23,-995338651),a=m(a,f,l,c,n[e],6,-198630844),c=m(c,a,f,l,n[e+7],10,1126891415),l=m(l,c,a,f,n[e+14],15,-1416354905),f=m(f,l,c,a,n[e+5],21,-57434055),a=m(a,f,l,c,n[e+12],6,1700485571),c=m(c,a,f,l,n[e+3],10,-1894986606),l=m(l,c,a,f,n[e+10],15,-1051523),f=m(f,l,c,a,n[e+1],21,-2054922799),a=m(a,f,l,c,n[e+8],6,1873313359),c=m(c,a,f,l,n[e+15],10,-30611744),l=m(l,c,a,f,n[e+6],15,-1560198380),f=m(f,l,c,a,n[e+13],21,1309151649),a=m(a,f,l,c,n[e+4],6,-145523070),c=m(c,a,f,l,n[e+11],10,-1120210379),l=m(l,c,a,f,n[e+2],15,718787259),f=m(f,l,c,a,n[e+9],21,-343485551),a=v(a,r),f=v(f,i),l=v(l,u),c=v(c,o);return[a,f,l,c]}(function(n){var t,e=[];for(e[(n.length>>2)-1]=void 0,t=0;t<e.length;t+=1)e[t]=0;var r=8*n.length;for(t=0;t<r;t+=8)e[t>>5]|=(255&n[t/8])<<t%32;return e}(n),8*n.length))}));var _=function(n,t,e){var r=t&&e||0;"string"==typeof n&&(t="binary"===n?new Array(16):null,n=null);var i=(n=n||{}).random||(n.rng||u)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||c(i)};function k(n,t,e,r){switch(n){case 0:return t&e^~t&r;case 1:return t^e^r;case 2:return t&e^t&r^e&r;case 3:return t^e^r}}function O(n,t){return n<<t|n>>>32-t}var j=p("v5",80,(function(n){var t=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof n){var r=unescape(encodeURIComponent(n));n=new Array(r.length);for(var i=0;i<r.length;i++)n[i]=r.charCodeAt(i)}n.push(128);var u=n.length/4+2,o=Math.ceil(u/16),a=new Array(o);for(i=0;i<o;i++){a[i]=new Array(16);for(var f=0;f<16;f++)a[i][f]=n[64*i+4*f]<<24|n[64*i+4*f+1]<<16|n[64*i+4*f+2]<<8|n[64*i+4*f+3]}for(a[o-1][14]=8*(n.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(n.length-1)&4294967295,i=0;i<o;i++){for(var l=new Array(80),c=0;c<16;c++)l[c]=a[i][c];for(c=16;c<80;c++)l[c]=O(l[c-3]^l[c-8]^l[c-14]^l[c-16],1);var s=e[0],h=e[1],y=e[2],p=e[3],v=e[4];for(c=0;c<80;c++){var x=Math.floor(c/20),d=O(s,5)+k(x,h,y,p)+v+t[x]+l[c]>>>0;v=p,p=y,y=O(h,30)>>>0,h=s,s=d}e[0]=e[0]+s>>>0,e[1]=e[1]+h>>>0,e[2]=e[2]+y>>>0,e[3]=e[3]+p>>>0,e[4]=e[4]+v>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,255&e[0],e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,255&e[1],e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,255&e[2],e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,255&e[3],e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,255&e[4]]}))},function(n,t,e){"use strict";function r(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}e.r(t),e.d(t,"Point",(function(){return C})),e.d(t,"Vector",(function(){return i})),e.d(t,"isclose",(function(){return a})),e.d(t,"clip",(function(){return f})),e.d(t,"dot",(function(){return u})),e.d(t,"cross",(function(){return o})),e.d(t,"Edge",(function(){return E})),e.d(t,"Polygon",(function(){return S})),e.d(t,"NavMesh",(function(){return Z}));var i=function(){function n(t,e){if(function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),"number"!=typeof t||"number"!=typeof e)throw new Error("Vector components must be numbers.");this.x=t,this.y=e}var t,e,i;return t=n,(e=[{key:"_normOther",value:function(t){return"number"==typeof t?new n(t,t):t}},{key:"add",value:function(t){return t=this._normOther(t),new n(this.x+t.x,this.y+t.y)}},{key:"sub",value:function(t){return t=this._normOther(t),new n(this.x-t.x,this.y-t.y)}},{key:"mul",value:function(t){return t=this._normOther(t),new n(this.x*t.x,this.y*t.y)}},{key:"div",value:function(t){return t=this._normOther(t),new n(this.x/t.x,this.y/t.y)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(n){return a(this.x,n.x)&&a(this.y,n.y)}},{key:"angle",value:function(n){return Math.acos(f(-1,1,u(this,n)/(this.length()*n.length())))}},{key:"counterclockwiseAngle",value:function(n){var t=this.angle(n);return o(this,n)>=0?t:2*Math.PI-t}},{key:"toString",value:function(){return"{ x: ".concat(this.x,", y: ").concat(this.y," }")}}])&&r(t.prototype,e),i&&r(t,i),n}();function u(n,t){return n.x*t.x+n.y*t.y}function o(n,t){return n.x*t.y-n.y*t.x}function a(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8;return n>t-e&&n<t+e}function f(n,t,e){return e<n?n:e>t?t:e}var l=e(0),c=e(1),s=e.n(c),h=e(2),y=e.n(h),p=e(3),v=e.n(p);class x{constructor(n=[],t=d){if(this.data=n,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const n=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:t,compare:e}=this,r=t[n];for(;n>0;){const i=n-1>>1,u=t[i];if(e(r,u)>=0)break;t[n]=u,n=i}t[n]=r}_down(n){const{data:t,compare:e}=this,r=this.length>>1,i=t[n];for(;n<r;){let r=1+(n<<1),u=t[r];const o=r+1;if(o<this.length&&e(t[o],u)<0&&(r=o,u=t[o]),e(u,i)>=0)break;t[n]=u,n=r}t[n]=i}}function d(n,t){return n<t?-1:n>t?1:0}function g(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function b(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?g(Object(e),!0).forEach((function(t){m(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):g(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function m(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function w(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){if(!(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n)))return;var e=[],r=!0,i=!1,u=void 0;try{for(var o,a=n[Symbol.iterator]();!(r=(o=a.next()).done)&&(e.push(o.value),!t||e.length!==t);r=!0);}catch(n){i=!0,u=n}finally{try{r||null==a.return||a.return()}finally{if(i)throw u}}return e}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function k(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function O(n,t,e){return t&&k(n.prototype,t),e&&k(n,e),n}function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}function P(n,t,e){return(P=j()?Reflect.construct:function(n,t,e){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(n,r));return e&&A(i,e.prototype),i}).apply(null,arguments)}function A(n,t){return(A=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function N(n){return function(n){if(Array.isArray(n)){for(var t=0,e=new Array(n.length);t<n.length;t++)e[t]=n[t];return e}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function M(n){return n instanceof Array?P(i,N(n)):n instanceof i?n:n.hasOwnProperty("x")&&n.hasOwnProperty("y")?new i(n.x,n.y):void 0}var E=function(){function n(t,e){_(this,n),this._uuid=Object(l.uuid)(),this.p1=M(t),this.p2=M(e)}return O(n,[{key:"length",value:function(){return this.p1.sub(this.p2).length()}},{key:"direction",value:function(){return this.p1.sub(this.p2)}},{key:"onEdge",value:function(n){n=M(n);var t=this.p1.sub(n);if(!this.parallel(t))return!1;var e=this.direction(),r=this.length(),i=u(e,t)/(r*r);return i>=0&&i<=1}},{key:"parallel",value:function(n){var t=n instanceof i?n:n.p1.sub(n.p2);return a(o(this.direction(),t),0)}},{key:"collinear",value:function(n){var t=this.direction(),e=this.p1.sub(n.p1),r=this.p1.sub(n.p2);return a(o(t,e),0)&&a(o(t,r),0)}},{key:"overlap",value:function(t){if(!this.collinear(t))throw new Error("Cannot compute overlap of two non-collinear edges.");var e=[];return this.onEdge(t.p1)&&e.push(t.p1),this.onEdge(t.p2)&&e.push(t.p2),t.onEdge(this.p1)&&e.push(this.p1),t.onEdge(this.p2)&&e.push(this.p2),e.length>2&&(e=e.filter((function(n,t){return e.findIndex((function(t){return t.equals(n)}))===t}))),e.length?(1==e.length&&(e=[e[0],e[0]]),P(n,N(e))):null}},{key:"equals",value:function(n){return this.p1.equals(n.p1)&&this.p2.equals(n.p2)||this.p1.equals(n.p2)&&this.p2.equals(n.p1)}}]),n}(),S=function(){function n(t){_(this,n),this._uuid=Object(l.uuid)(),this.points=t.map(M),this.bounds=this._computeBounds()}return O(n,[{key:"_computeBounds",value:function(){return this.points.reduce((function(n,t){return[Math.min(t.x,n[0]),Math.min(t.y,n[1]),Math.max(t.x,n[2]),Math.max(t.y,n[3])]}),[1/0,1/0,-1/0,-1/0])}},{key:"edges",value:function(){var n=this;return this.points.map((function(t,e){return new E(0==e?n.points[n.points.length-1]:n.points[e-1],t)}))}},{key:"centroid",value:function(){return this.points.reduce((function(n,t){return n.add(t)}),new i(0,0)).div(this.points.length)}},{key:"centroidDistance",value:function(n){return this.centroid().sub(n.centroid()).length()}},{key:"contains",value:function(n){n=M(n);var t=this.points.map(this._toPointArray);return s()(this._toPointArray(n),t)||!!this.onEdge(n)}},{key:"_toPointArray",value:function(n){return[n.x,n.y]}},{key:"onEdge",value:function(n){n=M(n);var t=!0,e=!1,r=void 0;try{for(var i,u=this.edges()[Symbol.iterator]();!(t=(i=u.next()).done);t=!0){var o=i.value;if(o.onEdge(n))return o}}catch(n){e=!0,r=n}finally{try{t||null==u.return||u.return()}finally{if(e)throw r}}return null}},{key:"touches",value:function(n){var t=!0,e=!1,r=void 0;try{for(var i,u=this.edges()[Symbol.iterator]();!(t=(i=u.next()).done);t=!0){var o=i.value;if((o.onEdge(n.p1)||o.onEdge(n.p2))&&o.collinear(n))return o}}catch(n){e=!0,r=n}finally{try{t||null==u.return||u.return()}finally{if(e)throw r}}return null}},{key:"boundsSize",value:function(){var n=w(this.bounds,4),t=n[0],e=n[1];return{x:t,y:e,w:n[2]-t,h:n[3]-e}}}]),n}(),Z=function(){function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_(this,n),this._uuid=Object(l.uuid)(),this.polygons=this._triangulate(t).map((function(n){return new S(n)})),this.costFunc=e,this.heuristicFunc=r,this._buildQuadtree(),this._buildNeighbors()}return O(n,[{key:"_triangulate",value:function(n){var t=this,e=[],r=!0,i=!1,u=void 0;try{for(var o,a=function(){for(var n=o.value,r=y()(t._flatten(n)),i=0;i<r.length/3;i++){var u=r.slice(3*i,3*i+3);e.push(u.map((function(t){return n[t]})))}},f=n[Symbol.iterator]();!(r=(o=f.next()).done);r=!0)a()}catch(n){i=!0,u=n}finally{try{r||null==f.return||f.return()}finally{if(i)throw u}}return e}},{key:"_flatten",value:function(n){var t=[],e=!0,r=!1,i=void 0;try{for(var u,o=n[Symbol.iterator]();!(e=(u=o.next()).done);e=!0){var a=u.value;a instanceof Array?t.push.apply(t,N(a)):t.push(a.x,a.y)}}catch(n){r=!0,i=n}finally{try{e||null==o.return||o.return()}finally{if(r)throw i}}return t}},{key:"_buildQuadtree",value:function(){this.qt=v()(-1/0,-1/0,1/0,1/0);var n=!0,t=!1,e=void 0;try{for(var r,i=this.polygons[Symbol.iterator]();!(n=(r=i.next()).done);n=!0){var u=r.value;this.qt.put(b({},u.boundsSize(),{polygon:u}))}}catch(n){t=!0,e=n}finally{try{n||null==i.return||i.return()}finally{if(t)throw e}}}},{key:"_buildNeighbors",value:function(){this.polygons.forEach((function(n){return n.neighbors={}}));for(var n=0;n<this.polygons.length;n++){var t=this.polygons[n],e=!0,r=!1,i=void 0;try{for(var u,o=this.qt.get(t.boundsSize())[Symbol.iterator]();!(e=(u=o.next()).done);e=!0){var a=u.value.polygon;if(t!==a&&!t.neighbors.hasOwnProperty(a._uuid)){var f=this._computePortal(t,a);null!==f&&f.length()>0&&(t.neighbors[a._uuid]={polygon:a,portal:f},a.neighbors[t._uuid]={polygon:t,portal:f})}}}catch(n){r=!0,i=n}finally{try{e||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"_computePortal",value:function(n,t){var e=!0,r=!1,i=void 0;try{for(var u,o=n.edges()[Symbol.iterator]();!(e=(u=o.next()).done);e=!0){var a=u.value,f=t.touches(a);if(null!==f)return a.overlap(f)}}catch(n){r=!0,i=n}finally{try{e||null==o.return||o.return()}finally{if(r)throw i}}return null}},{key:"findPath",value:function(n,t){n=M(n),t=M(t);var e=this._findPath(n,t);return e&&this._funnel(n,t,e)}},{key:"_findPath",value:function(n,t){var e=this._findContainingPolygon(n),r=this._findContainingPolygon(t);if(null===e||null===r)return null;for(var i=new x([{cost:0,polygon:e}],(function(n,t){return n.cost-t.cost})),u=m({},e._uuid,null),o=m({},e._uuid,0);i.length;){var a=i.pop().polygon;if(a._uuid===r._uuid)break;for(var f=0,l=Object.values(a.neighbors);f<l.length;f++){var c=l[f].polygon,s=o[a._uuid]+this._computeCost(a,c);(!o.hasOwnProperty(c._uuid)||s<o[c._uuid])&&(i.push({cost:s+this._heuristic(c,r),polygon:c}),o[c._uuid]=s,u[c._uuid]=a)}}return this._reconstructPath(r,u)}},{key:"_computeDistance",value:function(n,t){return n.centroidDistance(t)}},{key:"_computeCost",value:function(n,t){if(null!==this.costFunc){var e=n.neighbors[t._uuid].portal;return this.costFunc(n,t,e)}return this._computeDistance(n,t)}},{key:"_heuristic",value:function(n,t){return n._uuid==t._uuid?0:null!==this.heuristicFunc?this.heuristicFunc(n,t):this._computeDistance(n,t)}},{key:"_findContainingPolygon",value:function(n){var t=.01*n.x,e={x:.99*n.x-t,y:.99*n.y-t,w:2*t,h:2*t},r=!0,i=!1,u=void 0;try{for(var o,a=this.qt.get(e)[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var f=o.value;if(f.polygon.contains(n))return f.polygon}}catch(n){i=!0,u=n}finally{try{r||null==a.return||a.return()}finally{if(i)throw u}}return null}},{key:"_reconstructPath",value:function(n,t){if(!t.hasOwnProperty(n._uuid))return null;for(var e=n,r=[];null!==e;)r.push(e),e=t[e._uuid];return r.reverse()}},{key:"_funnel",value:function(n,t,e){if(0===e.length)throw new Error("Path cannot be empty.");if(1===e.length)return[n,t];for(var r=[n],i=null,u=null,o=0;o<e.length-1;o++){var a=e[o],f=e[o+1],l=a.neighbors[f._uuid].portal,c=w(this._pointPortalEdges(n,l),2),s=c[0],h=c[1];if(null!==i&&null!==u&&(s=this._funnelEdge(i,u,s),h=this._funnelEdge(u,i,h),null===s||null===h)){var y=null===s?u:i,p=this._splitAt(e.slice(o-1),y.p2);r.push.apply(r,N(this._funnel(y.p2,t,p)));break}if(i=s,u=h,o===e.length-2){var v=new E(n,t),x=this._funnelEdge(i,u,v);x===i?r.push(i.p2):null===x&&r.push(u.p2),r.push(t)}}return r}},{key:"_pointPortalEdges",value:function(n,t){return o(t.p1.sub(n),t.p2.sub(n))<0?[new E(n,t.p2),new E(n,t.p1)]:[new E(n,t.p1),new E(n,t.p2)]}},{key:"_splitAt",value:function(n,t){var e=n.indexOf(N(n).reverse().find((function(n){return n.contains(t)})));return n.slice(e)}},{key:"_funnelEdge",value:function(n,t,e){var r=n.direction(),i=t.direction(),u=e.direction();return o(r,i)*o(r,u)<0?n:r.angle(u)<=r.angle(i)?e:null}}]),n}(),C=i}])}));
//# sourceMappingURL=nav2d_deps.min.js.map